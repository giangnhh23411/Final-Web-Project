<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shopping Cart - Phuc Long</title>
    <link rel="stylesheet" href="../Assets/CSS/shopping-cart.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Josefin+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Alata:wght@400&display=swap" rel="stylesheet">
</head>
<body>
    <div class="container">
        <!-- Header Section -->
        <header class="header">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="top-bar-left">
                    <span class="email">sales@phuclong.masangroup.com</span>
                    <span class="phone">1800 6779</span>
                </div>
                <div class="top-bar-right">
                    <span class="language">VIE</span>
                    <span class="currency">VND</span>
                    <span class="login">Login</span>
                    <span class="wishlist">Wishlist</span>
                    <div class="cart-icon">
                        <img src="../Assets/images/shopping-cart/Group.png" alt="Cart" class="cart-icon-img">
                    </div>
                </div>
            </div>
            
            <!-- Navigation Bar -->
            <nav class="navbar">
                <div class="nav-left">
                    <div class="logo" onclick="goToHome()" style="cursor: pointer;">PHUC LONG</div>
                    <div class="cart-title">
                        <img src="../Assets/images/shopping-cart/11 shopping cart copy 1.png" alt="Shopping Cart" class="cart-icon-nav">
                        <span class="cart-text">SHOPPING CART</span>
                    </div>
                </div>
                <div class="nav-right">
                    <div class="nav-menu">
                        <span class="nav-item">Home</span>
                        <span class="nav-item">Pages</span>
                        <span class="nav-item">Products</span>
                        <span class="nav-item">Blog</span>
                        <span class="nav-item">Shop</span>
                        <span class="nav-item">Contact</span>
                    </div>
                    <div class="search-box">
                        <input type="text" placeholder="" class="search-input">
                        <button class="search-btn">
                            <img src="../Assets/images/shopping-cart/search-icon.svg" alt="Search" class="search-icon">
                        </button>
                    </div>
                </div>
            </nav>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <div class="cart-container">
                <!-- Left Column - Product List -->
                <div class="cart-left">
                    <div class="cart-table">
                        <div class="table-header">
                            <div class="col-checkbox">
                                <input type="checkbox" id="selectAll" class="select-all-checkbox">
                            </div>
                            <div class="col-product">Product</div>
                            <div class="col-price">Price</div>
                            <div class="col-quantity">Quantity</div>
                            <div class="col-total">Total</div>
                            <div class="col-action">Action</div>
                        </div>
                        
                        <!-- Product Items - Dynamic Content -->
                        <div class="product-list" id="productList">
                            <!-- Cart items will be loaded here dynamically -->
                        </div>
                    </div>
                    
                    <div class="cart-actions">
                        <button class="update-cart-btn" onclick="loadCartData()">Update Cart</button>
                        <button class="clear-cart-btn" onclick="clearCart()">Clear Cart</button>
                    </div>
                </div>

                <!-- Right Column - Cart Summary -->
                <div class="cart-right">
                    <div class="cart-summary">
                        <h3>Cart Totals</h3>
                        <div class="summary-row">
                            <span>Subtotals:</span>
                            <span id="subtotal">₫0</span>
                        </div>
                        <div class="summary-row">
                            <span>Totals:</span>
                            <span id="total">₫0</span>
                        </div>
                        <div class="shipping-info">
                            <span class="checkmark">✓</span>
                            <span>Shipping & taxes calculated at checkout</span>
                        </div>
                        <button class="checkout-btn">Proceed To Checkout</button>
                        <div class="calculate-shipping">
                            <h4>Calculate Shopping</h4>
                        </div>
                    </div>

                    <!-- Chat Icon -->
                    <div class="chat-icon-container">
                        <div class="chat-icon-btn" onclick="toggleChat()">
                            <span class="chat-icon">💬</span>
                            <span class="notification-dot">1</span>
                        </div>
                    </div>

                    <!-- Chat Widget (Hidden by default) -->
                    <div class="chat-widget" id="chatWidget" style="display: none;">
                        <div class="chat-header">
                            <h4>Chat</h4>
                            <button class="close-chat-btn" onclick="toggleChat()">×</button>
                        </div>
                        <div class="chat-content">
                            <div class="chat-sidebar">
                                <div class="pinned-conversations">
                                    <h5>📌 Pinned Conversations</h5>
                                    <div class="conversation-item">
                                        <span>Jane Carr</span>
                                        <span class="notification">1</span>
                                    </div>
                                    <div class="conversation-item">
                                        <span>Angel Lubin</span>
                                    </div>
                                    <div class="conversation-item">
                                        <span>Kaiya Levin</span>
                                        <span class="notification">1</span>
                                    </div>
                                    <div class="conversation-item">
                                        <span>Phillip Aminoff</span>
                                    </div>
                                </div>
                            </div>
                            <div class="chat-main">
                                <div class="chat-message">
                                    <div class="message-bubble">Hey!</div>
                                </div>
                                <div class="chat-input">
                                    <button class="attach-btn">+</button>
                                    <input type="text" placeholder="Message">
                                    <button class="mic-btn">🎤</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Footer Section -->
        <footer class="footer">
            <!-- Footer Content -->
            <div class="footer-content">
                <div class="footer-column">
                    <h3 class="footer-title">PHUC LONG</h3>
                    <div class="email-signup">
                        <input type="email" placeholder="Enter Email Address" class="email-input">
                        <button class="signup-btn">Sign Up</button>
                    </div>
                    <div class="contact-info">
                        <h4>Contact info:</h4>
                        <p>17 Princess Road, London, Greater London NW1 8JR, UK</p>
                    </div>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Categories</h3>
                    <ul class="footer-links">
                        <li><a href="#">Coffee</a></li>
                        <li><a href="#">Tea</a></li>
                        <li><a href="#">Others</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Customer Care</h3>
                    <ul class="footer-links">
                        <li><a href="#">My Account</a></li>
                        <li><a href="#">Discount</a></li>
                        <li><a href="#">Returns</a></li>
                        <li><a href="#">Orders History</a></li>
                        <li><a href="#">Order Tracking</a></li>
                    </ul>
                </div>
                
                <div class="footer-column">
                    <h3 class="footer-title">Pages</h3>
                    <ul class="footer-links">
                        <li><a href="#">Blog</a></li>
                        <li><a href="#">Products</a></li>
                        <li><a href="#">Terms and Services</a></li>
                        <li><a href="#">About us</a></li>
                    </ul>
                </div>
            </div>
            
            <!-- Copyright Bar -->
            <div class="copyright-bar">
                <div class="copyright-left">
                    <span>©Webecy - All Rights Reserved</span>
                </div>
                <div class="copyright-right">
                    <div class="social-icons">
                        <div class="social-icon facebook">
                            <img src="../Assets/images/shopping-cart/Group 202.png" alt="Facebook">
                        </div>
                        <div class="social-icon instagram">
                            <img src="../Assets/images/shopping-cart/Group 203.png" alt="Instagram">
                        </div>
                    </div>
                </div>
            </div>
        </footer>
    </div>

    <script>
        function toggleChat() {
            const chatWidget = document.getElementById('chatWidget');
            if (chatWidget.style.display === 'none') {
                chatWidget.style.display = 'block';
            } else {
                chatWidget.style.display = 'none';
            }
        }

        // Close chat when clicking outside
        document.addEventListener('click', function(event) {
            const chatWidget = document.getElementById('chatWidget');
            const chatIconBtn = document.querySelector('.chat-icon-btn');
            
            if (!chatWidget.contains(event.target) && !chatIconBtn.contains(event.target)) {
                chatWidget.style.display = 'none';
            }
        });

        // Load cart data from localStorage when page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Clear any existing sample data first
            clearSampleData();
            // Then load real cart data
            loadCartData();
        });

        function clearSampleData() {
            // Remove any hardcoded sample data
            const productContainer = document.querySelector('#productList');
            if (productContainer) {
                productContainer.innerHTML = '';
            }
        }
    </script>
    <script src="../Assets/JS/cart-manager.js"></script>
    <script>
        function loadCartData() {
            console.log('Loading cart data...');
            const cart = JSON.parse(localStorage.getItem('phuclong_cart') || '[]');
            console.log('Cart data:', cart);
            const productContainer = document.querySelector('#productList');
            
            if (!productContainer) {
                console.error('Product container not found!');
                return;
            }
            
            if (cart.length === 0) {
                productContainer.innerHTML = `
                    <div class="empty-cart" style="
                        text-align: center;
                        padding: 60px 20px;
                        background-color: #f8f9fa;
                        border-radius: 8px;
                        margin: 20px 0;
                    ">
                        <h3 style="color: #333; margin-bottom: 15px; font-size: 24px;">Giỏ hàng trống</h3>
                        <p style="color: #666; margin-bottom: 20px; font-size: 16px;">Bạn chưa có sản phẩm nào trong giỏ hàng.</p>
                        <a href="../ClientSite/index.html" style="
                            background-color: #fb2e86;
                            color: white;
                            padding: 12px 24px;
                            text-decoration: none;
                            border-radius: 4px;
                            font-weight: 600;
                            display: inline-block;
                        ">Tiếp tục mua sắm</a>
                    </div>
                `;
                updateCartSummary([]);
                return;
            }

            let html = '';
            cart.forEach((item, index) => {
                html += `
                    <div class="product-item">
                        <div class="product-checkbox">
                            <input type="checkbox" checked>
                        </div>
                        <div class="product-details">
                            <div class="product-image">
                                <img src="../Assets/images/${item.image}" alt="${item.name}">
                            </div>
                            <div class="product-info">
                                <h3>${item.name}</h3>
                                <p>Color: Brown</p>
                                <p>Size: M - L</p>
                            </div>
                            <div class="product-promotions">
                                <div class="promo-tag sale">SALE Buy 2, Get 1 Free</div>
                                <div class="promo-tag shipping">₫500K Off Shipping (No Min. Order)</div>
                            </div>
                        </div>
                        <div class="product-price">₫${item.price.toLocaleString()}</div>
                        <div class="product-quantity">
                            <button class="qty-btn minus" onclick="updateQuantity(${index}, ${item.quantity - 1})">-</button>
                            <input type="number" value="${item.quantity}" min="1" onchange="updateQuantity(${index}, this.value)">
                            <button class="qty-btn plus" onclick="updateQuantity(${index}, ${item.quantity + 1})">+</button>
                        </div>
                        <div class="product-total">₫${(item.price * item.quantity).toLocaleString()}</div>
                        <div class="product-actions">
                            <button class="delete-btn" onclick="removeFromCart(${index})">Delete</button>
                            <button class="similar-btn">Watch similar products</button>
                        </div>
                    </div>
                `;
            });

            productContainer.innerHTML = html;
            updateCartSummary(cart);
            console.log('Cart data loaded successfully');
        }

        function updateQuantity(index, quantity) {
            const cart = JSON.parse(localStorage.getItem('phuclong_cart') || '[]');
            if (cart[index]) {
                cart[index].quantity = parseInt(quantity);
                if (cart[index].quantity <= 0) {
                    cart.splice(index, 1);
                }
                localStorage.setItem('phuclong_cart', JSON.stringify(cart));
                loadCartData();
            }
        }

        function removeFromCart(index) {
            const cart = JSON.parse(localStorage.getItem('phuclong_cart') || '[]');
            cart.splice(index, 1);
            localStorage.setItem('phuclong_cart', JSON.stringify(cart));
            loadCartData();
        }

        function updateCartSummary(cart) {
            const subtotal = cart.reduce((total, item) => total + (item.price * item.quantity), 0);
            const total = subtotal; // No shipping for now
            
            document.getElementById('subtotal').textContent = `₫${subtotal.toLocaleString()}`;
            document.getElementById('total').textContent = `₫${total.toLocaleString()}`;
        }

        function clearCart() {
            if (confirm('Bạn có chắc chắn muốn xóa tất cả sản phẩm trong giỏ hàng?')) {
                localStorage.removeItem('phuclong_cart');
                loadCartData();
                alert('Đã xóa tất cả sản phẩm trong giỏ hàng!');
            }
        }

        function goToHome() {
            window.location.href = '../Home/home.html';
        }

        // Debug function to check localStorage
        function debugCart() {
            console.log('=== CART DEBUG ===');
            console.log('localStorage phuclong_cart:', localStorage.getItem('phuclong_cart'));
            console.log('Parsed cart:', JSON.parse(localStorage.getItem('phuclong_cart') || '[]'));
            console.log('==================');
        }

        // Make debug function global
        window.debugCart = debugCart;
    </script>
</body>
</html>