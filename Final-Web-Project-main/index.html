<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Phuc Long - Homepage</title>
  <base href="/" />
  <style>
    :root{
      --brand-purple-dark:#2b0054;--brand-purple:#4b008c;--brand-purple-light:#efe9ff;
      --brand-text-dark:#1a1a3a;--brand-text-mid:#5a5a7a;--accent-pink:#ff1f8a;
      --bg-page:#ffffff;--bg-section-alt:#f4f3ff;--border-card:#eeeeff;
      --footer-bg:#f3f3ff;--footer-bottom-bg:#e7e7ff;--radius-card:6px;
      --shadow-card:0 8px 20px rgba(0,0,0,0.06);--max-width-page:1280px;
      --font-main:"Inter",system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial,sans-serif;
    }
    *{box-sizing:border-box;-webkit-font-smoothing:antialiased}
    body{margin:0;font-family:var(--font-main);background:var(--bg-page);color:var(--brand-text-dark);line-height:1.4}
    a{text-decoration:none;color:inherit}
    img{max-width:100%;display:block}

    /* TOP CONTACT BAR (ƒë·ªãnh d·∫°ng ph·∫ßn trong header.html) */
    .top-contact-bar{background:var(--brand-purple-dark);color:#fff;font-size:12px;line-height:1}
    .top-contact-inner{max-width:var(--max-width-page);margin:0 auto;padding:6px 16px;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:8px;color:#fff}
    .contact-left,.contact-right{display:flex;flex-wrap:wrap;align-items:center;gap:16px;color:#fff}
    .contact-item{color:#fff;display:flex;align-items:center;gap:6px;white-space:nowrap}
    .search-bar{display:flex;align-items:center;background:#fff;border-radius:2px;overflow:hidden;border:1px solid #ccc;height:24px}
    .search-bar input{border:0;height:24px;padding:0 8px;font-size:12px;outline:none}
    .search-bar button{background:var(--accent-pink);color:#fff;border:0;height:24px;width:24px;font-size:12px;cursor:pointer;line-height:1}

    /* MAIN NAV */
    .main-nav-wrapper{border-bottom:1px solid #d9d9f9;background:#fff}
    .main-nav-inner{max-width:var(--max-width-page);margin:0 auto;padding:12px 16px;display:flex;flex-wrap:wrap;align-items:center;justify-content:space-between;gap:16px}
    .brand-area{font-size:18px;font-weight:600;color:var(--brand-text-dark);white-space:nowrap}
    .nav-links{display:flex;flex-wrap:wrap;gap:16px;font-size:13px;color:var(--brand-text-dark)}
    .nav-links a{color:var(--brand-text-dark);position:relative}
    .nav-links a.active{color:var(--accent-pink)}
    .nav-links a.active::after{content:"";position:absolute;left:0;right:0;bottom:-4px;height:2px;background:var(--accent-pink);border-radius:1px}

    /* === BANNER 1 (Hero) ‚Äî nh·ªè l·∫°i ~1/2, n·ªÅn t√≠m √¥m ·∫£nh === */
    .hero{
      background-color:var(--brand-purple-dark);
      background-image:url("Assets/images/Banner%201.jpg");
      background-repeat:no-repeat;background-position:center;background-size:contain;
      height:clamp(200px,28vw,380px);padding:8px 0;
    }
    /* === BANNER 2 (Combo) === */
    .combo-banner{
      background-color:var(--brand-purple-dark);
      background-image:url("Assets/images/Banner%202.jpg");
      background-repeat:no-repeat;background-position:center;background-size:contain;
      height:clamp(160px,24vw,320px);
    }
    /* === NEWSLETTER LEFT (ChienGameSanQua) === */
    .newsletter-left{
      background-color:var(--brand-purple-dark);
      background-image:url("Assets/images/ChienGameSanQua.jpg");
      background-repeat:no-repeat;background-position:center;background-size:contain;
      height:clamp(140px,22vw,260px);border-radius:var(--radius-card);
      box-shadow:var(--shadow-card);border:1px solid var(--border-card);
    }

    /* BEST SELLERS */
    .section-best-sellers{max-width:var(--max-width-page);margin:32px auto 16px;padding:0 16px}
    .carousel-header{text-align:center;font-size:18px;font-weight:600;color:var(--brand-text-dark);text-transform:uppercase;margin-bottom:24px}
    .carousel{position:relative;display:flex;align-items:center}
    .carousel-window{overflow:hidden;width:100%}
    .carousel-track{display:flex;flex-wrap:nowrap;gap:16px;scroll-behavior:smooth}
    .product-card{flex:0 0 200px;background:#fff;border-radius:var(--radius-card);box-shadow:var(--shadow-card);border:1px solid var(--border-card);padding:16px;text-align:center;font-size:13px;line-height:1.4}
    .product-img{display:flex;align-items:center;justify-content:center;height:140px;margin-bottom:12px;position:relative}
    .product-img img{max-height:140px;object-fit:contain}
    .product-name{font-size:13px;font-weight:600;color:#d10071;margin-bottom:6px}
    .product-size{font-size:12px;color:#1a1a3a;line-height:1.3}
    .product-price{font-size:12px;font-weight:500;color:#1a1a3a;margin-top:4px}
    .carousel-arrow{background:#fff;color:var(--accent-pink);font-size:20px;font-weight:600;width:32px;height:32px;border-radius:4px;border:2px solid var(--accent-pink);box-shadow:var(--shadow-card);cursor:pointer;user-select:none;line-height:28px;text-align:center}
    .carousel-arrow.left{margin-right:8px}.carousel-arrow.right{margin-left:8px}

    /* COLLECTION */
    .collection-wrapper{background:var(--bg-section-alt);border-top:1px solid #dedcff;border-bottom:1px solid #dedcff;margin-top:32px}
    .collection-inner{max-width:var(--max-width-page);margin:0 auto;padding:32px 16px;display:grid;gap:24px;align-items:center}
    @media(min-width:768px){.collection-inner{grid-template-columns:1fr 1fr}}
    .collection-image-card{background:#fff;border-radius:var(--radius-card);box-shadow:var(--shadow-card);border:1px solid var(--border-card);padding:16px;max-width:320px}
    .collection-image-card img{width:100%;height:auto;object-fit:cover}
    .collection-copy h3{font-size:20px;font-weight:700;color:var(--brand-purple-dark);margin:0 0 8px;line-height:1.3;text-transform:uppercase}
    .collection-copy h3 span{display:block}
    .collection-copy .bullets{font-size:13px;color:var(--brand-text-mid);line-height:1.5;margin-top:16px}
    .collection-copy .bullets p{margin:0 0 8px}
    .collection-copy .cta-btn{display:inline-block;background:var(--accent-pink);color:#fff;border-radius:2px;padding:8px 16px;font-size:13px;font-weight:600;margin-top:16px}

    /* DISCOUNT */
    .discount-section{max-width:var(--max-width-page);margin:0 auto;padding:32px 16px 48px}
    .discount-header{text-align:center;margin-bottom:24px}
    .discount-header h2{margin:0;font-size:20px;line-height:1.4;font-weight:600;color:var(--brand-text-dark)}
    .discount-tabs{margin-top:8px;font-size:13px;color:var(--accent-pink);display:flex;flex-wrap:wrap;gap:12px;justify-content:center}
    .discount-tabs a{color:var(--accent-pink);text-decoration:none}
    .discount-body{display:grid;gap:24px;align-items:start}
    @media(min-width:768px){.discount-body{grid-template-columns:1fr 1fr}}
    .discount-text{font-size:14px;color:var(--brand-text-dark);max-width:480px}
    .discount-text .percent{color:var(--brand-purple-dark);font-size:18px;font-weight:600;margin-bottom:8px}
    .discount-text .product-title{color:var(--accent-pink);font-weight:600;font-size:15px;margin-bottom:12px}
    .discount-text p.desc{font-size:13px;line-height:1.5;color:var(--brand-text-mid);margin:0 0 12px}
    .checklist{display:flex;flex-wrap:wrap;font-size:13px;color:var(--brand-text-dark);line-height:1.4;margin:0 -8px 16px;padding:0;list-style:none}
    .checklist li{width:50%;padding:4px 8px}
    .checklist li::before{content:"‚úì ";color:var(--accent-pink);font-weight:600}
    .btn-shop-now{display:inline-block;background:var(--accent-pink);color:#fff;border-radius:2px;padding:8px 16px;font-size:13px;font-weight:600;text-decoration:none}
    .discount-visual{position:relative;text-align:center}
    .discount-circle-bg{position:absolute;top:30px;left:50%;transform:translateX(-50%);width:200px;height:200px;background:#ffeef6;border-radius:50%;z-index:0}
    .discount-image-wrapper{position:relative;z-index:1;max-width:220px;margin:0 auto}
    .discount-image-wrapper img{width:100%;height:auto;object-fit:contain}

    /* NEWSLETTER CTA */
    .newsletter-banner{background:var(--bg-section-alt);border-top:1px solid #dedcff;border-bottom:1px solid #dedcff}
    .newsletter-inner{max-width:var(--max-width-page);margin:0 auto;padding:24px 16px;display:grid;align-items:center;gap:24px}
    @media(min-width:768px){.newsletter-inner{grid-template-columns:2fr 1fr}}

    /* BLOG */
    .blog-section{max-width:var(--max-width-page);margin:32px auto 48px;padding:0 16px}
    .blog-header{text-align:center;margin-bottom:24px}
    .blog-header h2{margin:0;font-size:20px;font-weight:600;line-height:1.4;color:var(--brand-purple-dark)}
    .blog-cards{display:grid;gap:16px}
    @media(min-width:768px){.blog-cards{grid-template-columns:repeat(3,1fr)}}
    .blog-card{background:#fff;border-radius:var(--radius-card);box-shadow:var(--shadow-card);border:1px solid var(--border-card);overflow:hidden;display:flex;flex-direction:column}
    .blog-image img{width:100%;height:160px;object-fit:cover;display:block}
    .blog-content{padding:16px;font-size:13px;color:var(--brand-text-mid);line-height:1.4;flex:1}
    .blog-meta{font-size:11px;color:var(--brand-text-mid);display:flex;flex-wrap:wrap;align-items:center;gap:8px;margin-bottom:8px}
    .blog-title{font-size:13px;font-weight:600;color:var(--brand-text-dark);line-height:1.4;margin-bottom:8px}
    .blog-desc{font-size:12px;color:var(--brand-text-mid);line-height:1.4;margin-bottom:8px}
    .blog-readmore{font-size:12px;font-weight:600;color:var(--accent-pink);text-decoration:none}


    /* PRODUCT ICONS */
    .product-icons{position:absolute;top:8px;right:8px;display:flex;gap:5px;opacity:0;transition:opacity .3s ease}
    .product-card:hover .product-icons{opacity:1}
    .cart-icon-btn,.heart-icon-btn{background:rgba(255,255,255,.9);border:none;border-radius:50%;width:32px;height:32px;display:flex;align-items:center;justify-content:center;cursor:pointer;font-size:14px;transition:all .3s ease;box-shadow:0 2px 4px rgba(0,0,0,.1)}
    .cart-icon-btn:hover{background:var(--accent-pink);color:#fff;transform:scale(1.1)}
    .heart-icon-btn:hover{background:#ff6b6b;color:#fff;transform:scale(1.1)}

    /* CART BADGE */
    .cart-link{position:relative}
    .cart-badge{position:absolute;top:-5px;right:-5px;background:var(--accent-pink);color:#fff;border-radius:50%;width:20px;height:20px;font-size:12px;display:flex;align-items:center;justify-content:center;font-weight:bold}

    /* RESPONSIVE */
    @media(max-width:480px){
      .checklist li{width:100%}
      .newsletter-inner{grid-template-columns:1fr}
      .footer-top{grid-template-columns:1fr}
    }

    /* ===== STORE LOCATOR ===== */
    .store-locator{max-width:var(--max-width-page);margin:32px auto;padding:0 16px}
    .sl-grid{display:grid;gap:16px}
    @media(min-width:992px){.sl-grid{grid-template-columns:1.4fr 1fr}}
    #sl-map{width:100%;height:420px;border:1px solid #dedcff;border-radius:8px}
    .sl-panel{border:1px solid #dedcff;border-radius:8px;padding:12px}
    .sl-toolbar{display:flex;flex-wrap:wrap;gap:8px;margin-bottom:10px}
    .sl-toolbar input,.sl-toolbar select{height:34px;padding:0 10px;border:1px solid #ddd;border-radius:6px;font-size:13px}
    .sl-toolbar button{height:34px;padding:0 12px;border-radius:6px;border:1px solid #ddd;background:#fff;cursor:pointer}
    .sl-toolbar button.primary{background:#fb2e86;color:#fff;border-color:#fb2e86}
    #sl-list{display:flex;flex-direction:column;gap:10px;max-height:420px;overflow:auto}
    .sl-item{display:grid;grid-template-columns:40px 1fr;gap:10px;padding:10px;border:1px solid #eee;border-radius:8px;background:#fff}
    .sl-avatar{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:#efe9ff;color:#4b008c;font-weight:700}
    .sl-meta{font-size:12px;color:var(--brand-text-mid);line-height:1.5}
    .sl-status{color:#6b7280}
    .sl-status.open{color:#16a34a}
    .sl-distance{margin-left:8px;color:#0d9488}
    .sl-btn{display:inline-block;margin-top:6px;padding:6px 10px;border-radius:6px;background:#f3f4f6}
    .sl-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:10px}
  </style>
</head>
<body>
  <!-- Header ƒë∆∞·ª£c load ƒë·ªông -->
  <div id="header-placeholder"></div>

  <!-- HERO -->
  <section class="hero"><div class="hero-inner"></div></section>

  <!-- BEST SELLERS 1 -->
  <section class="section-best-sellers">
    <div class="carousel-header">BEST SELLERS ‚Äì TR√Ä TH∆†M CH·∫§T L∆Ø·ª¢NG</div>
    <div class="carousel" data-carousel="1">
      <button class="carousel-arrow left" data-dir="left">‚Äπ</button>
      <div class="carousel-window">
        <div class="carousel-track" id="carousel-track-1">
          <!-- Products will be loaded dynamically -->
        </div>
      </div>
      <button class="carousel-arrow right" data-dir="right">‚Ä∫</button>
    </div>
  </section>

  <!-- BEST SELLERS 2 -->
  <section class="section-best-sellers">
    <div class="carousel-header">BEST SELLERS ‚Äì TR√Ä S·ªÆA ƒê·∫¨M V·ªä</div>
    <div class="carousel" data-carousel="2">
      <button class="carousel-arrow left" data-dir="left">‚Äπ</button>
      <div class="carousel-window">
        <div class="carousel-track" id="carousel-track-2">
          <!-- Products will be loaded dynamically -->
        </div>
      </div>
      <button class="carousel-arrow right" data-dir="right">‚Ä∫</button>
    </div>
  </section>

  <!-- COLLECTION -->
  <section class="collection-wrapper">
    <div class="collection-inner">
      <div class="collection-image-card">
        <img src="Assets/images/ƒê√°m c∆∞·ªõi k·∫π.jpg" alt="B·ªô s∆∞u t·∫≠p ƒê√°m c∆∞·ªõi k·∫π" />
      </div>
      <div class="collection-copy">
        <h3><span>B·ªò S∆ØU T·∫¨P</span><span>ƒê√ÅM CU·ªêI K·∫∏</span></h3>
        <div class="bullets">
          <p>BST phi√™n b·∫£n Halloween ‚Äì ƒë·ªì u·ªëng & b√°nh ng·ªçt phong c√°ch gothic.</p>
          <p>H·ª£p t√°c Ph√∫c Long √ó ShopeeFood; combo "ƒÇn H·ª∑ Nh√† K·∫π" ch·ªâ 89K (gi√° g·ªëc 114K).</p>
          <p>√Åp d·ª•ng t·∫°i c·ª≠a h√†ng Ph√∫c Long ch·ªçn l·ªçc & ƒë·∫∑t qua ShopeeFood; s·ªë l∆∞·ª£ng v√† th·ªùi gian c√≥ h·∫°n.</p>
        </div>
        <a class="cta-btn" href="/ClientSite/shop-list.html">XEM NGAY</a>
      </div>
    </div>
  </section>

  <!-- COMBO BANNER -->
  <section class="combo-banner"></section>

  <!-- DISCOUNT -->
  <section class="discount-section">
    <div class="discount-header">
      <h2>Discount Item</h2>
        <div class="discount-tabs">
        <a href="/ClientSite/shop-list.html">Milk Tea ‚Ä¢</a><a href="/ClientSite/shop-list.html">Fruit Tea</a><a href="/ClientSite/shop-grid.html">Bakery Collections</a>
      </div>
    </div>
    <div class="discount-body">
      <div class="discount-text">
        <div class="percent">20% Discount</div>
        <div class="product-title">Tr√† s·ªØa Ph√∫c Long</div>
        <p class="desc">Experience the perfect harmony of bold tea flavor and smooth creamy milk ‚Äî a timeless signature of Phuc Long. Brewed from premium tea leaves, our milk tea delivers an authentic aroma and balanced sweetness that refreshes every sip.</p>
        <ul class="checklist">
          <li>Made from hand-picked tea leaves</li>
          <li>Creamy yet light milk flavor</li>
          <li>Perfect balance of sweetness</li>
          <li>Served fresh daily</li>
        </ul>
        <a class="btn-shop-now" href="/ClientSite/shop-list.html">Shop Now</a>
      </div>
      <div class="discount-visual">
        <div class="discount-circle-bg"></div>
        <div class="discount-image-wrapper">
          <img src="Assets/images/Tr√† s·ªØa ƒë·∫≠m v·ªã/TraSuaPL.png" alt="Tr√† s·ªØa Ph√∫c Long" />
        </div>
      </div>
    </div>
  </section>

  <!-- NEWSLETTER CTA -->
  <section class="newsletter-banner">
    <div class="newsletter-inner">
      <div class="newsletter-left"></div>
      <div class="newsletter-right">
        <h3>Get Latest Update By Subscribe Our Newsletter</h3>
        <a class="btn-shop-now" href="/ClientSite/shop-list.html">Shop Now</a>
      </div>
    </div>
  </section>

  <!-- BLOG -->
  <section class="blog-section">
    <div class="blog-header"><h2>Latest Blog</h2></div>
    <div class="blog-cards">
      <!-- Blog 1 -->
      <article class="blog-card">
        <div class="blog-image">
          <img src="Assets/images/blog1-in.jpg" alt="Boogey Wedding ‚Äì Halloween Collection | Phuc Long" />
        </div>
        <div class="blog-content">
          <div class="blog-meta">
            <div>‚ú¶ Phuc Long Team</div>
            <div>üìÖ 25 October, 2025</div>
          </div>
          <div class="blog-title">Boogey Wedding ‚Äì Halloween Collection</div>
          <div class="blog-desc">
            Step into Phuc Long‚Äôs spooky season with ‚ÄúBoogey Wedding‚Äù ‚Äî a limited Halloween
            collection featuring gothic-style beverages and sweet treats, now available
            at select stores and ShopeeFood combos.
          </div>
          <a class="blog-readmore" href="/ClientSite/blog1.html">Read More</a>
        </div>
      </article>
      <!-- Blog 2 -->
      <article class="blog-card">
        <div class="blog-image">
          <img src="Assets/images/blog2-in.jpg" alt="Game On Top ‚Äì 100% Prizes | Phuc Long" />
        </div>
        <div class="blog-content">
          <div class="blog-meta">
            <div>‚ú¶ Phuc Long Team</div>
            <div>üìÖ 10 October, 2025</div>
          </div>
          <div class="blog-title">Game On Top ‚Äì 100% Prizes</div>
          <div class="blog-desc">
            Join Phuc Long‚Äôs mini-game ‚ÄúGame On Top‚Äù and win instantly ‚Äî 100% chance of prizes.
            Play, share, climb the leaderboard, and redeem drink vouchers throughout the campaign.
          </div>
          <a class="blog-readmore" href="/ClientSite/blog2.html">Read More</a>
        </div>
      </article>
      <!-- Blog 3 -->
      <article class="blog-card">
        <div class="blog-image">
          <img src="Assets/images/blog3-in.jpg" alt="Mad for Tea ‚Äì 100% Prizes | Phuc Long" />
        </div>
        <div class="blog-content">
          <div class="blog-meta">
            <div>‚ú¶ Phuc Long Team</div>
            <div>üìÖ 24 June, 2025</div>
          </div>
          <div class="blog-title">Mad for Tea ‚Äì 100% Prizes</div>
          <div class="blog-desc">
            Open the mini-game, complete tasks, and hunt for 100,000 free cups of tea ‚Äî 100% win rate.
            Play daily, invite friends, and claim exclusive Phuc Long rewards.
          </div>
          <a class="blog-readmore" href="/ClientSite/blog3.html">Read More</a>
        </div>
      </article>
    </div>
  </section>

  <!-- STORE LOCATOR (MAP) -->
  <section class="store-locator" id="store-locator">
    <h2 style="text-align:center;margin:0 0 16px">Danh s√°ch c·ª≠a h√†ng Ph√∫c Long</h2>

    <div class="sl-toolbar">
      <input id="sl-q" type="search" placeholder="T√¨m t√™n/ƒë·ªãa ch·ªâ c·ª≠a h√†ng‚Ä¶" style="flex:1;min-width:200px">
      <select id="sl-province" style="min-width:160px">
        <option value="">T·ªânh th√†nh</option>
      </select>
      <select id="sl-district" style="min-width:160px">
        <option value="">Qu·∫≠n/huy·ªán</option>
      </select>
      <select id="sl-ward" style="min-width:160px">
        <option value="">Ph∆∞·ªùng/x√£</option>
      </select>
      <button id="sl-locate" title="L·∫•y v·ªã tr√≠ c·ªßa b·∫°n">üìç V·ªã tr√≠ c·ªßa t√¥i</button>
      <button id="sl-sort" data-active="0" title="S·∫Øp theo kho·∫£ng c√°ch">‚Üï S·∫Øp x·∫øp</button>
      <button id="sl-clear" title="X√≥a l·ªçc">‚úñ X√≥a</button>
    </div>

    <div class="sl-grid">
      <div id="sl-map"></div>
      <div class="sl-panel">
        <div class="sl-header">
          <strong>Danh s√°ch c·ª≠a h√†ng</strong>
          <span><b id="sl-count">0</b> c·ª≠a h√†ng</span>
        </div>
        <div id="sl-list"></div>
      </div>
    </div>
  </section>

  <!-- Footer ƒë∆∞·ª£c load ƒë·ªông -->
  <div id="footer-placeholder"></div>

  <script>
    // Load header/footer ƒë·ªông v·ªõi ƒë∆∞·ªùng d·∫´n ƒê√öNG t·∫°i root
    async function loadComponent(url, placeholderId){
      try{
        const res = await fetch(url,{cache:"no-cache"});
        if(!res.ok) throw new Error(`${res.status} ${res.statusText}`);
        const html = await res.text();
        const placeholder = document.getElementById(placeholderId);
        placeholder.innerHTML = html;
        
        // Ch·∫°y l·∫°i c√°c script trong component sau khi inject (ƒë·∫∑c bi·ªát cho header)
        if (placeholderId === 'header-placeholder') {
          const scripts = placeholder.querySelectorAll('script');
          scripts.forEach(oldScript => {
            const newScript = document.createElement('script');
            Array.from(oldScript.attributes).forEach(attr => {
              newScript.setAttribute(attr.name, attr.value);
            });
            newScript.textContent = oldScript.textContent;
            oldScript.parentNode.replaceChild(newScript, oldScript);
          });
        }
      }catch(err){
        console.error(`Load component failed: ${url}`, err);
        document.getElementById(placeholderId).innerHTML =
          `<p style="text-align:center;color:red;">L·ªói t·∫£i ${url}. Vui l√≤ng ki·ªÉm tra file t·ªìn t·∫°i.</p>`;
      }
    }

    document.addEventListener('DOMContentLoaded', async ()=>{
      await loadComponent('/Assets/Components/header.html','header-placeholder');
      await loadComponent('/Assets/Components/footer.html','footer-placeholder');
      initPage();
    });

    /* === CART MANAGER === */
    class CartManager{
      constructor(){ this.cart=this.loadCart(); this.updateCartIcon(); }
      saveCart(){
        localStorage.setItem('phuclong_cart', JSON.stringify(this.cart));
        const currentUser = JSON.parse(localStorage.getItem('phuclong_current_user')||'null');
        if(currentUser){
          localStorage.setItem(`phuclong_cart_${currentUser.id}`, JSON.stringify(this.cart));
        }
        this.updateCartIcon();
      }
      loadCart(){ const saved=localStorage.getItem('phuclong_cart'); return saved?JSON.parse(saved):[]; }
      addToCart(product){
        const ex=this.cart.find(i=>i.id===product.id);
        if(ex){ ex.quantity+=1; } else { this.cart.push({...product, quantity:1}); }
        this.saveCart(); this.showSuccessMessage(product.name);
      }
      removeFromCart(id){ this.cart=this.cart.filter(i=>i.id!==id); this.saveCart(); }
      updateQuantity(id,q){ const it=this.cart.find(i=>i.id===id); if(it){ if(q<=0)this.removeFromCart(id); else{ it.quantity=q; this.saveCart(); } } }
      getTotalItems(){ return this.cart.reduce((t,i)=>t+i.quantity,0); }
      getTotalPrice(){ return this.cart.reduce((t,i)=>t+i.price*i.quantity,0); }
      updateCartIcon(){
        const icons=document.querySelectorAll('.cart-icon, .cart-link');
        const total=this.getTotalItems();
        icons.forEach(icon=>{
          const ex=icon.querySelector('.cart-badge'); if(ex) ex.remove();
          if(total>0){
            const b=document.createElement('span'); b.className='cart-badge'; b.textContent=total;
            icon.style.position='relative'; icon.appendChild(b);
          }
        });
      }
      showConfirmDialog(product){
        const old=document.querySelector('.cart-confirm-modal'); if(old) document.body.removeChild(old);
        const modal=document.createElement('div'); modal.className='cart-confirm-modal';
        modal.style.cssText=`position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000`;
        modal.innerHTML=`
          <div class="modal-content" style="background:#fff;padding:30px;border-radius:8px;text-align:center;max-width:400px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,.3);">
            <h3 style="color:#0d0e43;margin-bottom:20px;font-size:20px;">Th√™m v√†o gi·ªè h√†ng</h3>
            <div style="margin-bottom:20px;">
              <img src="${product.image}" alt="${product.name}" style="width:80px;height:80px;object-fit:contain;border-radius:8px;background:#f8f9fa;padding:8px;margin-bottom:15px;">
              <p style="color:#666;font-size:16px;">B·∫°n c√≥ mu·ªën th√™m <strong>"${product.name}"</strong> v√†o gi·ªè h√†ng kh√¥ng?</p>
            </div>
            <div style="display:flex;gap:15px;justify-content:center;">
              <button class="btn-cancel" style="background:#f8f9fa;color:#666;border:1px solid #ddd;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">Kh√¥ng</button>
              <button class="btn-confirm" style="background:#fb2e86;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">C√≥</button>
            </div>
          </div>`;
        document.body.appendChild(modal);
        modal.querySelector('.btn-cancel').addEventListener('click',()=>document.body.removeChild(modal));
        modal.querySelector('.btn-confirm').addEventListener('click',()=>{ this.addToCart(product); document.body.removeChild(modal); });
        modal.addEventListener('click',(e)=>{ if(e.target===modal) document.body.removeChild(modal); });
      }
      showSuccessMessage(name){
        const n=document.createElement('div'); n.style.cssText=`position:fixed;top:20px;right:20px;background:#28a745;color:#fff;padding:15px 20px;border-radius:4px;z-index:10001;font-weight:600;box-shadow:0 2px 10px rgba(0,0,0,.2)`; n.textContent=`ƒê√£ th√™m "${name}" v√†o gi·ªè h√†ng!`; document.body.appendChild(n);
        setTimeout(()=>{ if(document.body.contains(n)) document.body.removeChild(n); },3000);
      }
      goToCart(){ window.location.href='ClientSite/shopping-cart.html'; }
    }
    const cartManager=new CartManager();

    function addToCart(id,name,price,image){
      const isLoggedIn = localStorage.getItem('phuclong_user_logged_in')==='true';
      if(!isLoggedIn){ showLoginDialog(); return; }
      cartManager.showConfirmDialog({id,name,price:parseFloat(price),image});
    }

    /* === Auth lightweight for demo === */
    function showLoginDialog(){
      const modal=document.createElement('div'); modal.className='login-modal';
      modal.style.cssText=`position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000`;
      modal.innerHTML=`
        <div class="modal-content" style="background:#fff;padding:30px;border-radius:8px;text-align:center;max-width:450px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,.3);">
          <h3 style="color:#0d0e43;margin-bottom:20px;font-size:20px;">ƒêƒÉng nh·∫≠p</h3>
          <form id="loginForm" style="text-align:left;">
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">T√†i kho·∫£n:</label>
              <input type="text" id="loginUsername" placeholder="Nh·∫≠p t√†i kho·∫£n" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required>
            </div>
            <div style="margin-bottom:20px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">M·∫≠t kh·∫©u:</label>
              <input type="password" id="loginPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required>
            </div>
            <div style="display:flex;gap:10px;justify-content:center;margin-bottom:15px;">
              <button type="button" class="btn-cancel" style="background:#f8f9fa;color:#666;border:1px solid #ddd;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">H·ªßy</button>
              <button type="submit" class="btn-login" style="background:#fb2e86;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">ƒêƒÉng nh·∫≠p</button>
            </div>
            <div style="text-align:center;">
              <button type="button" class="btn-register" style="background:none;border:none;color:#fb2e86;cursor:pointer;text-decoration:underline;font-size:14px;">Ch∆∞a c√≥ t√†i kho·∫£n? ƒêƒÉng k√Ω ngay</button>
            </div>
          </form>
        </div>`;
      document.body.appendChild(modal);
      modal.querySelector('.btn-cancel').addEventListener('click',()=>document.body.removeChild(modal));
      modal.querySelector('.btn-register').addEventListener('click',()=>{ document.body.removeChild(modal); showRegisterDialog(); });
      modal.querySelector('#loginForm').addEventListener('submit',(e)=>{
        e.preventDefault();
        const u=document.getElementById('loginUsername').value;
        const p=document.getElementById('loginPassword').value;
        if(loginUser(u,p)){ document.body.removeChild(modal); showSuccessMessage('ƒêƒÉng nh·∫≠p th√†nh c√¥ng!'); }
        else{ showErrorMessage('T√†i kho·∫£n ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!'); }
      });
      modal.addEventListener('click',(e)=>{ if(e.target===modal) document.body.removeChild(modal); });
    }
    function showRegisterDialog(){
      const modal=document.createElement('div'); modal.className='register-modal';
      modal.style.cssText=`position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000`;
      modal.innerHTML=`
        <div class="modal-content" style="background:#fff;padding:30px;border-radius:8px;text-align:center;max-width:500px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,.3);max-height:90vh;overflow-y:auto;">
          <h3 style="color:#0d0e43;margin-bottom:20px;font-size:20px;">ƒêƒÉng k√Ω t√†i kho·∫£n</h3>
          <form id="registerForm" style="text-align:left;">
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">H·ªç t√™n:</label><input type="text" id="registerName" placeholder="Nh·∫≠p h·ªç t√™n" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">T√†i kho·∫£n:</label><input type="text" id="registerUsername" placeholder="Nh·∫≠p t√†i kho·∫£n" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">Email:</label><input type="email" id="registerEmail" placeholder="Nh·∫≠p email" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">S·ªë ƒëi·ªán tho·∫°i:</label><input type="tel" id="registerPhone" placeholder="Nh·∫≠p s·ªë ƒëi·ªán tho·∫°i" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="margin-bottom:15px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">M·∫≠t kh·∫©u:</label><input type="password" id="registerPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="margin-bottom:20px;"><label style="display:block;margin-bottom:5px;font-weight:600;color:#333;">X√°c nh·∫≠n m·∫≠t kh·∫©u:</label><input type="password" id="registerConfirmPassword" placeholder="Nh·∫≠p l·∫°i m·∫≠t kh·∫©u" style="width:100%;padding:10px;border:1px solid #ddd;border-radius:4px;font-size:14px;" required></div>
            <div style="display:flex;gap:10px;justify-content:center;margin-bottom:15px;">
              <button type="button" class="btn-cancel" style="background:#f8f9fa;color:#666;border:1px solid #ddd;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">H·ªßy</button>
              <button type="submit" class="btn-register" style="background:#fb2e86;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">ƒêƒÉng k√Ω</button>
            </div>
            <div style="text-align:center;">
              <button type="button" class="btn-login" style="background:none;border:none;color:#fb2e86;cursor:pointer;text-decoration:underline;font-size:14px;">ƒê√£ c√≥ t√†i kho·∫£n? ƒêƒÉng nh·∫≠p</button>
            </div>
          </form>
        </div>`;
      document.body.appendChild(modal);
      modal.querySelector('.btn-cancel').addEventListener('click',()=>document.body.removeChild(modal));
      modal.querySelector('.btn-login').addEventListener('click',()=>{ document.body.removeChild(modal); showLoginDialog(); });
      modal.querySelector('#registerForm').addEventListener('submit',(e)=>{
        e.preventDefault();
        const name=document.getElementById('registerName').value;
        const username=document.getElementById('registerUsername').value;
        const email=document.getElementById('registerEmail').value;
        const phone=document.getElementById('registerPhone').value;
        const password=document.getElementById('registerPassword').value;
        const confirm=document.getElementById('registerConfirmPassword').value;
        if(password!==confirm){ showErrorMessage('M·∫≠t kh·∫©u x√°c nh·∫≠n kh√¥ng kh·ªõp!'); return; }
        if(registerUser(name,username,email,phone,password)){
          document.body.removeChild(modal);
          showSuccessMessage('ƒêƒÉng k√Ω th√†nh c√¥ng! Vui l√≤ng ƒëƒÉng nh·∫≠p.');
          setTimeout(()=>showLoginDialog(),800);
        }else{ showErrorMessage('T√†i kho·∫£n ƒë√£ t·ªìn t·∫°i!'); }
      });
      modal.addEventListener('click',(e)=>{ if(e.target===modal) document.body.removeChild(modal); });
    }
    function showSuccessMessage(m){
      const n=document.createElement('div'); n.style.cssText=`position:fixed;top:20px;right:20px;background:#28a745;color:#fff;padding:15px 20px;border-radius:4px;z-index:10001;font-weight:600;box-shadow:0 2px 10px rgba(0,0,0,.2)`; n.textContent=m; document.body.appendChild(n);
      setTimeout(()=>{ if(document.body.contains(n)) document.body.removeChild(n); },3000);
    }
    function showErrorMessage(m){
      const n=document.createElement('div'); n.style.cssText=`position:fixed;top:20px;right:20px;background:#dc3545;color:#fff;padding:15px 20px;border-radius:4px;z-index:10001;font-weight:600;box-shadow:0 2px 10px rgba(0,0,0,.2)`; n.textContent=m; document.body.appendChild(n);
      setTimeout(()=>{ if(document.body.contains(n)) document.body.removeChild(n); },3000);
    }
    function goToCart(){ cartManager.goToCart(); }

    // Simple local auth demo
    function registerUser(name,username,email,phone,password){
      const users=JSON.parse(localStorage.getItem('phuclong_users')||'[]');
      if(users.find(u=>u.username===username)) return false;
      const newUser={id:Date.now(),name,username,email,phone,password,createdAt:new Date().toISOString()};
      users.push(newUser); localStorage.setItem('phuclong_users',JSON.stringify(users)); return true;
    }
    function loginUser(username,password){
      const users=JSON.parse(localStorage.getItem('phuclong_users')||'[]');
      const user=users.find(u=>u.username===username && u.password===password);
      if(user){
        localStorage.setItem('phuclong_user_logged_in','true');
        localStorage.setItem('phuclong_current_user',JSON.stringify({id:user.id,name:user.name,username:user.username,email:user.email,phone:user.phone}));
        const userCart=JSON.parse(localStorage.getItem(`phuclong_cart_${user.id}`)||'[]');
        localStorage.setItem('phuclong_cart',JSON.stringify(userCart));
        return true;
      }
      return false;
    }
    function logoutUser(){
      const currentUser=JSON.parse(localStorage.getItem('phuclong_current_user')||'null');
      const currentCart=JSON.parse(localStorage.getItem('phuclong_cart')||'[]');
      if(currentUser && currentCart.length>0){
        localStorage.setItem(`phuclong_cart_${currentUser.id}`,JSON.stringify(currentCart));
      }
      localStorage.removeItem('phuclong_user_logged_in');
      localStorage.removeItem('phuclong_current_user');
      localStorage.removeItem('phuclong_cart');
    }
    function toggleLogin(){
      const isLoggedIn=localStorage.getItem('phuclong_user_logged_in')==='true';
      if(isLoggedIn){ showLogoutConfirmDialog(); } else { showLoginDialog(); }
    }
    function showLogoutConfirmDialog(){
      const modal=document.createElement('div'); modal.style.cssText=`position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:10000`;
      modal.innerHTML=`
        <div class="modal-content" style="background:#fff;padding:30px;border-radius:8px;text-align:center;max-width:400px;width:90%;box-shadow:0 4px 20px rgba(0,0,0,.3);">
          <h3 style="color:#0d0e43;margin-bottom:20px;font-size:20px;">X√°c nh·∫≠n ƒëƒÉng xu·∫•t</h3>
          <p style="color:#666;margin-bottom:20px;">B·∫°n c√≥ ch·∫Øc ch·∫Øn mu·ªën ƒëƒÉng xu·∫•t kh√¥ng?</p>
          <div style="display:flex;gap:15px;justify-content:center;">
            <button class="btn-cancel" style="background:#f8f9fa;color:#666;border:1px solid #ddd;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">H·ªßy</button>
            <button class="btn-confirm-logout" style="background:#dc3545;color:#fff;border:none;padding:10px 20px;border-radius:4px;cursor:pointer;font-weight:600;">ƒêƒÉng xu·∫•t</button>
          </div>
        </div>`;
      document.body.appendChild(modal);
      modal.querySelector('.btn-cancel').addEventListener('click',()=>document.body.removeChild(modal));
      modal.querySelector('.btn-confirm-logout').addEventListener('click',()=>{
        logoutUser();
        const loginStatus=document.getElementById('loginStatus'); if(loginStatus) loginStatus.textContent='Login';
        showSuccessMessage('ƒê√£ ƒëƒÉng xu·∫•t!'); cartManager.updateCartIcon(); document.body.removeChild(modal);
      });
      modal.addEventListener('click',(e)=>{ if(e.target===modal) document.body.removeChild(modal); });
    }
    function updateLoginStatus(){
      const isLoggedIn=localStorage.getItem('phuclong_user_logged_in')==='true';
      const loginStatus=document.getElementById('loginStatus');
      if(loginStatus) loginStatus.textContent = isLoggedIn ? 'Logout' : 'Login';
    }

    /* Load Best Sellers from API */
    async function loadBestSellers(){
      try{
        // Load all products (with large pageSize to get all)
        const response = await fetch('/api/products?page=1&pageSize=500');
        if(!response.ok) throw new Error('Failed to load products');
        const result = await response.json();
        const allProducts = result.data || [];
        
        // Load categories to check category name
        const catResponse = await fetch('/api/products/categories');
        const catResult = await catResponse.json();
        const categories = catResult.data || [];
        
        // Find "Th·ª©c u·ªëng" category
        const thucUongCategory = categories.find(cat => 
          cat.name && (cat.name.toLowerCase().includes('th·ª©c u·ªëng') || cat.name.toLowerCase().includes('thuc uong'))
        );
        
        // Filter products for "TR√Ä TH∆†M CH·∫§T L∆Ø·ª¢NG"
        // - Name starts with "tr√†", "Tr√†", or "H·ªìng tr√†"
        // - Belongs to "Th·ª©c u·ªëng" category
        const traThomProducts = allProducts.filter(product => {
          const name = (product.name || '').toLowerCase();
          const startsWithTra = name.startsWith('tr√†') || name.startsWith('h·ªìng tr√†');
          // Compare category_id as strings (both are converted to strings in API response)
          const inThucUong = thucUongCategory && 
            String(product.category_id) === String(thucUongCategory._id);
          return startsWithTra && inThucUong;
        });
        
        // Filter products for "TR√Ä S·ªÆA ƒê·∫¨M V·ªä"
        // - Name contains "tr√† s·ªØa"
        const traSuaProducts = allProducts.filter(product => {
          const name = (product.name || '').toLowerCase();
          return name.includes('tr√† s·ªØa');
        });
        
        // Limit to 15 products per carousel
        const traThomProductsLimited = traThomProducts.slice(0, 15);
        const traSuaProductsLimited = traSuaProducts.slice(0, 15);
        
        // Render products
        renderProducts('carousel-track-1', traThomProductsLimited);
        renderProducts('carousel-track-2', traSuaProductsLimited);
        
        // Re-initialize carousel after products are loaded
        setTimeout(() => {
          initCarousels();
        }, 100);
        
      }catch(error){
        console.error('Error loading best sellers:', error);
      }
    }
    
    function renderProducts(trackId, products){
      const track = document.getElementById(trackId);
      if(!track) return;
      
      track.innerHTML = '';
      
      if(products.length === 0){
        track.innerHTML = '<div style="padding:20px;text-align:center;color:#999;">Kh√¥ng c√≥ s·∫£n ph·∫©m</div>';
        return;
      }
      
      products.forEach(product => {
        const card = createProductCard(product);
        track.appendChild(card);
      });
    }
    
    function createProductCard(product){
      const card = document.createElement('div');
      card.className = 'product-card';
      card.style.cursor = 'pointer';
      
      const sku = product.sku || '';
      const name = product.name || '';
      const price = product.price || 0;
      const image = product.images && product.images.length > 0 ? product.images[0] : '';
      
      card.onclick = () => goToProductDetail(sku);
      
      const formattedPrice = formatPrice(price);
      
      card.innerHTML = `
        <div class="product-img">
          <img src="${image}" alt="${name}" onerror="this.src='Assets/images/placeholder.png'" />
          <div class="product-icons">
            <button class="cart-icon-btn" onclick="event.stopPropagation(); addToCartFromCard('${sku}', '${name.replace(/'/g, "\\'")}', ${price}, '${image}')">üõí</button>
            <button class="heart-icon-btn" onclick="event.stopPropagation();">‚ù§Ô∏è</button>
          </div>
        </div>
        <div class="product-name">${name}</div>
        <div class="product-price">${formattedPrice}</div>
      `;
      
      return card;
    }
    
    function formatPrice(price){
      if(!price) return '0‚Ç´';
      return new Intl.NumberFormat('vi-VN').format(price) + '‚Ç´';
    }
    
    function addToCartFromCard(sku, name, price, image){
      const isLoggedIn = localStorage.getItem('phuclong_user_logged_in')==='true';
      if(!isLoggedIn){ 
        showLoginDialog(); 
        return; 
      }
      cartManager.showConfirmDialog({id: sku, name, price: parseFloat(price), image});
    }
    
    function initCarousels(){
      document.querySelectorAll(".carousel").forEach((carouselEl)=>{
        const track=carouselEl.querySelector(".carousel-track");
        const windowEl=carouselEl.querySelector(".carousel-window");
        const leftBtn=carouselEl.querySelector(".carousel-arrow.left");
        const rightBtn=carouselEl.querySelector(".carousel-arrow.right");
        
        if(!track || !windowEl || !leftBtn || !rightBtn) return;
        
        // Remove old event listeners by cloning
        const newLeftBtn = leftBtn.cloneNode(true);
        const newRightBtn = rightBtn.cloneNode(true);
        leftBtn.parentNode.replaceChild(newLeftBtn, leftBtn);
        rightBtn.parentNode.replaceChild(newRightBtn, rightBtn);
        
        const getStep=()=>{
          const card=track.querySelector(".product-card");
          if(!card) return 220;
          const style=window.getComputedStyle(card);
          const cardWidth=card.getBoundingClientRect().width;
          const marginRight=parseFloat(style.marginRight)||0;
          return cardWidth + marginRight + 16;
        };
        newLeftBtn.addEventListener("click",()=>windowEl.scrollBy({left:-getStep(),behavior:"smooth"}));
        newRightBtn.addEventListener("click",()=>windowEl.scrollBy({left:getStep(),behavior:"smooth"}));
        windowEl.style.scrollBehavior="smooth";
        windowEl.style.overflowX="auto";
        windowEl.style.scrollSnapType="x mandatory";
        track.querySelectorAll(".product-card").forEach(card=>{ card.style.scrollSnapAlign="start"; });
      });
    }

    /* INIT after header/footer loaded */
    function initPage(){
      cartManager.updateCartIcon();
      updateLoginStatus();
      
      // Load best sellers from API
      loadBestSellers();
      
      // Initialize carousels
      initCarousels();
      
      console.log('Home page loaded with dynamic header/footer');
    }

    function goToProductDetail(sku){
      if(!sku){
        console.error('SKU is required');
        return;
      }
      window.location.href = `/ClientSite/product-details.html?sku=${encodeURIComponent(sku)}`;
    }
  </script>

  <!-- JS c·ªßa store-locator -->
  <script src="/Assets/JS/map.js"></script>

  <!-- Google Maps (thay API key c·ªßa b·∫°n) -->
  <script async defer src="https://maps.googleapis.com/maps/api/js?key=YOUR_GOOGLE_MAPS_API_KEY&libraries=marker&callback=initLocatorMap"></script>
  
  <!-- Footer ƒë∆∞·ª£c load ƒë·ªông -->
  <div id="footer-placeholder"></div>
</body>
</html>
